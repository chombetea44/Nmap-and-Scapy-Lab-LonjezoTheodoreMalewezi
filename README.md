# Network Scanning & Packet Analysis Lab
This repository documents the process and results of performing network survailance using Nmap and packet‑level inspection using Scapy. The goal of the lab was to understand how different scanning techniques reveal information about a target system, and how packet sniffing can be used to observe network behavior in real time.

## Objectives
Nmap
*	Identify the operating system of a target machine.
* 	Enumerate open ports and running services.
* 	Investigate SMB services and shared folders.
* 	Connect to discovered SMB shares for verification.
* 	Capture and analyze network traffic related to scanning activity.
  
Scapy
* Sniff live network traffic.
*	Observe ICMP packets generated by pings.
* 	Capture traffic on a specific interface.
* 	Apply filters to capture only certain packet types.
* 	Inspect and summarize captured packets.

## Setup
Environment
*	Linux machine with root access.
* 	Nmap installed.
* 	Scapy installed (Python-based tool).
* 	Wireshark installed for packet analysis.
  
  




## Nmap Scans
### 1. OS Detection
* **sudo nmap -O 192.168.1.63**


Used to identify the operating system running on the target. The  flag enables operating system fingerprinting.

<img width="955" height="910" alt="Screenshot_2025-12-17_13_06_06" src="https://github.com/user-attachments/assets/04aca255-df73-4ccb-8710-4c4d3f9688ca" />


### 2. FTP Service Scan
* **nmap -p21 -sV -A -T24 192.168.1.63**

* 	**-p21** scans the FTP port
*   **-sV** detects service versions
* 	 **-A** enables aggressive scanning
* 	 **-T24** increases scan speed
  
This scan confirmed whether FTP was running and provided version details.

<img width="955" height="910" alt="Screenshot_2025-12-17_13_14_18" src="https://github.com/user-attachments/assets/25ee0ecb-0c13-43da-8f6a-293e5132f7b7" />

### 3. SMB Port Scan
* **nmap -A -p139,445 192.168.1.63**

Focused on SMB-related ports to identify Windows file‑sharing services and potential vulnerabilities.

### 4. SMB Share Enumeration
* **nmap --script smb-enum-shares.nse -p445 192.168.1.63**

This Nmap script is used to list available SMB shares on the target.

### 5. SMB Share Access
* **smbclient //192.168.1.63/print$ -N**

Connected to the discovered **print$** share.**

**-N** tells the prompt not to ask for a password.

Exit the SMB shell using: **exit** command

### 6. Network Information Commands
These commands were used to check the local machine’s network configuration before capturing traffic.

* **ifconfig**

Displays network interfaces, IP addresses, and MAC addresses. This helps confirm which interface is active.

*  **ip route**
 
Shows the routing table, including the default gateway. Useful for understanding how packets leave the system.

* **cat /etc/resolv.conf**
 
Reveals the DNS servers the system is using. This matters when analyzing DNS traffic or troubleshooting name resolution.

<img width="955" height="910" alt="Screenshot_2025-12-17_14_02_02" src="https://github.com/user-attachments/assets/123470cf-4269-4ff8-96dd-3d719f0f21d9" />

## Packet Capture

A packet capture was performed to observe network traffic during scanning.

### Start Capture

* **sudo tcpdump -i eth0 -s 0 -w ladies.pcap**
*	**-s 0** captures the full packet.
* **-w ladies.pcap** saves the capture to a file named **ladies** with the extension **pcap**.


### Stop Capture
Press: **Ctrl + C**

### Verify File
* **ls ladies.pcap**
<img width="955" height="271" alt="Screenshot_2025-12-17_14_20_53" src="https://github.com/user-attachments/assets/7a59cb49-92d5-44e4-9c5c-6f2ad4eaa596" />

### Analyze in Wireshark
* **wireshark**

The  file was opened to inspect packets generated during the Nmap scans.

<img width="955" height="910" alt="Screenshot_2025-12-17_14_22_05" src="https://github.com/user-attachments/assets/875af154-bc93-45d0-ad4a-ebdb8a837eee" />

## Scapy Packet Analysis

* **sudo su**
  Switches to the root user, since Scapy needs elevated privileges.
### 1. Launch Scapy

* **scapy**

### 2. Basic Sniffing
* **sniff()**

In another terminal:
* **ping google.com**

This generates ICMP traffic so that Scapy has something to capture.

Both processes were stopped with **Ctrl + C**.

<img width="955" height="910" alt="Screenshot_2025-12-17_15_17_54" src="https://github.com/user-attachments/assets/75506d74-5b80-4260-bc1a-df3940cb9f2b" />

<img width="955" height="910" alt="Screenshot_2025-12-17_15_30_32" src="https://github.com/user-attachments/assets/38203753-b715-4487-84a6-4fd4e0f670c3" />

* **paro = _**
In Scapy, **_** stores the last returned value. Here, it saves the sniffed packets into a variable named **paro**.

* **paro.summary()**
Displays a summary of each captured packet


### 3. Sniffing on a Specific Interface

* **sniff(iface="br-internal")**

Traffic was generated by:

* Pinging the internal network:
* **ping 192.168.1.63/24**


* Opening a browser and visiting:
* http://192.168.1.63
* 
<img width="1920" height="922" alt="Screenshot_2025-12-18_15_54_49" src="https://github.com/user-attachments/assets/3dbd1bbe-01f7-47c6-9d03-fecc746e17f0" />

Captured packets were saved:
* **paro2 = _**
* **paro2.summary()**



### 4. Filtered Sniffing (ICMP Only)
* **sniff(iface="br-internal", filter="icmp", count=5)**
  
Traffic generated:
* **ping 192.168.1.63**


Captured packets:
* **paro3 = _**
* **paro3.summary()**
* **paro3[3]**



## Results
Nmap Findings
*   The target responded to OS fingerprinting, revealing general OS characteristics.
*  FTP service was detected on port 21 with version information.
* 	SMB ports (139 and 445) were open, indicating Windows file‑sharing services.
* 	The  script identified accessible SMB shares.
* 	The  share allowed anonymous access.
Packet Capture Results
* 	The  file contained traffic generated by Nmap scans and SMB interactions.
* 	Wireshark analysis showed SYN packets, SMB negotiation, and OS detection probes.
* 
Scapy Findings
* 	Initial sniffing captured ICMP packets from the Google ping.
* 	Interface‑specific sniffing captured internal network traffic and HTTP requests.
* 	Filtered sniffing successfully isolated ICMP packets.
* 	Packet summaries and individual packet inspection provided insight into structure and flow.

## Conclusion
This lab demonstrated how Nmap and Scapy complement each other:
* 	Nmap provides high‑level reconnaissance, revealing services, ports, and system details.
* 	Scapy offers low‑level visibility, allowing direct observation of packets generated during scans and normal network activity.
Together, they form a powerful toolkit for network analysis, penetration testing, and understanding how systems communicate on a network.


